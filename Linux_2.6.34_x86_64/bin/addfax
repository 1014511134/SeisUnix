#! /bin/sh
# Shell: addfax
# Usage: addfax -s	to update SYSTEM faxphonebook
#               -p	to update a user's PERSONAL faxphonebook
# Authors: John Stockwell and Jack K. Cohen
# Modify either PERSONAL or SYSTEM faxphonebooks

PATH=/bin:/usr/bin:/usr/ucb

SYSPDIR=/usr/local/lib
LOCPDIR=$HOME/lib

# check for arguments
for i
do
	case $i in
	-s)	# update system faxphonebook
		if
			cp $SYSPDIR/faxphonebook $SYSPDIR/faxphonebook.bak
		then
			echo "SYSTEM faxphonebook backed up as:"
			echo "     $SYSPDIR/faxphonebook.bak"
		fi
		sleep 1

		exec vi $SYSPDIR/faxphonebook
		1>&2; exit 1
	;;
	-p)	# update users locally defined faxphonebook
		cd $HOME
		if test ! -d lib
		then
		echo "$HOME/lib doesn't exist, creating"
			mkdir lib
		fi

		cd lib

		if test ! -f faxphonebook
		then
		echo "$HOME/lib/faxphonebook doesn't exist, creating"
		touch faxphonebook
		chmod 600 faxphonebook

		exec vi $LOCPDIR/faxphonebook
		1>&2; exit 1
		fi

		if
			cp $LOCPDIR/faxphonebook $LOCPDIR/faxphonebook.bak
		then
			echo "PRIVATE faxphonebook backed up as:"
			echo "     $LOCPDIR/faxphonebook.bak"
		fi
		sleep 2

		exec vi $LOCPDIR/faxphonebook
		1>&2; exit 1
	;;
	esac
done

# else echo a usage message
echo "Usage: addfax -s		to update the SYSTEM faxphonebook"
echo "              -p		to update a user's PERSONAL faxphonebook"

exit 0
