#! /bin/sh
# Shell: addemail
# Usage: addemail -s	to update SYSTEM emailbook
#               -p	to update a user's PERSONAL emailbook
# Authors: John Stockwell and Jack K. Cohen
# Modify either PERSONAL or SYSTEM emailbooks

PATH=/bin:/usr/bin:/usr/ucb

SYSPDIR=/usr/local/lib
LOCPDIR=$HOME/lib

# check for arguments
for i
do
	case $i in
	-s)	# update system emailbook
		if
			cp $SYSPDIR/emailbook $SYSPDIR/emailbook.bak
		then
			echo "SYSTEM emailbook backed up as:"
			echo "     $SYSPDIR/emailbook.bak"
		fi
		sleep 1

		exec vi $SYSPDIR/emailbook
		1>&2; exit 1
	;;
	-p)	# update users locally defined emailbook
		cd $HOME
		if test ! -d lib
		then
		echo "$HOME/lib doesn't exist, creating"
			mkdir lib
		fi

		cd lib

		if test ! -f emailbook
		then
		echo "$HOME/lib/emailbook doesn't exist, creating"
		touch emailbook
		chmod 600 emailbook

		exec vi $LOCPDIR/emailbook
		1>&2; exit 1
		fi

		if
			cp $LOCPDIR/emailbook $LOCPDIR/emailbook.bak
		then
			echo "PRIVATE emailbook backed up as:"
			echo "     $LOCPDIR/emailbook.bak"
		fi
		sleep 2

		exec vi $LOCPDIR/emailbook
		1>&2; exit 1
	;;
	esac
done

# else echo a usage message
echo "Usage: addemail -s		to update the SYSTEM emailbook"
echo "                -p		to update a user's PERSONAL emailbook"

exit 0
